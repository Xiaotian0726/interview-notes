- [0、Cache](#0cache)
- [1、中断](#1中断)
- [2、CPU 流水线](#2cpu-流水线)

# 0、Cache
Cache 是位于 CPU 和主存之间的高速缓冲存储器，通常由 `SRAM` 组成

Cache 替换算法：
* RAND
* FIFO
* LRU 近期最少使用算法
* LFU 最不经常使用

Cache 的写操作及一致性：
* 写直达法（write through）：CPU 执行写操作时，数据同时写入 Cache 和主存。这样当 Cache 的某一块被换出时，不需要再写入主存，一致性高，但频繁访问主存降低了平均方寸速度
* 写回法（write back）：CPU 执行写操作时，暂时只写入 Cache，不写入主存。只有当某一块 Cache 被替换出时，才写回主存。在这种方式下，Cache 的内容与主存的内容并不是时刻保持一致的

Cache 的性能指标：
* Cache 命中率
* 平均访存时间
* 加速比
* 访存效率

# 1、中断
中断是指计算机运行过程中，出现某些意外情况需主机干预，机器能暂停正在运行的程序，并转入处理新程序，处理完毕后又返回原程序继续运行的机制

中断的过程：
* 中断响应：中断响应时，CPU 自动完成如下过程：
  * 取中断类型号 N
  * 标志寄存器 FLAGS 入栈
  * 保存原程序断点（CS、IP 入栈）
  * 禁止硬件中断和单步中断（IF、TF 清零）
  * 转中断服务处理程序入口地址（从中断向量表取 4N 单元的字内容送 IP，4N+2 单元的字内容送 CS
* 中断处理：一般中断处理程序的设计格式：
  * 保存现场
  * 开中断（STI）
  * 中断处理程序主体部分
  * 中断结束（EOI）（硬件中断时）
  * 关中断（CLI）
  * 恢复现场
  * 中断返回（IRET）
* 中断返回：中断返回时，CPU 自动完成：
  * 恢复原程序的断点（先后恢复 IP、CS）
  * 标志寄存器 FLAGS 从栈恢复

# 2、CPU 流水线
流水线冒险（hazard）：
* 结构冒险：指令竞争硬件资源，即硬件不支持多条指令在同一个时钟周期同时运行
* 数据冒险：生产数据的源指令和消费数据的目的指令重叠执行时，不能满足程序要求的数据处理先后关系
* 控制冒险：条件转移指令做出决定前，其后续指令已经出现在流水线中，如果决定的结果与已经进入流水线的指令序列不同的话，后续的指令就是无效的